<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Donor List | PRC Baguio</title>
<style>
body { font-family:"Segoe UI", Arial, sans-serif; background:#fff; margin:0; color:#333; }
header { display:flex; align-items:center; gap:15px; padding:15px 30px; border-bottom:4px solid #c62828; }
header img { height:55px; }
header h2 { color:#c62828; margin:0; font-weight:700; }

/* Container */
.container { max-width:1200px; margin:25px auto; padding:20px; }

/* Buttons */
button { background:#c62828; color:white; border:none; padding:10px 18px; border-radius:6px; font-weight:600; cursor:pointer; }
button:hover { background:#a91f1f; }
.secondary { background:#eeeeee; color:#333; }
.secondary:hover { background:#ddd; }
.noPrint {}

/* Search */
.searchRow { display:flex; gap:10px; align-items:center; margin-bottom:15px; flex-wrap:wrap; }

/* Table */
table { width:100%; border-collapse:collapse; }
th, td { border:1px solid #000; padding:6px; font-size:13px; text-align:center; }
th { background:#c62828; color:#fff; font-weight:700; }

/* Blood type colors */
.A { background:#2196f3; color:white; }
.B { background:#ffeb3b; color:#000; }
.AB { background:#e91e63; color:white; }
.O { background:#fff; color:#000; }

/* Print */
@media print {
  body { margin:0; font-size:12px; }
  @page { size:A4 landscape; margin:0.5in; }
  .noPrint { display:none; }
  table { width:100%; border:1px solid #000; border-collapse:collapse; }
  th, td { border:1px solid #000; padding:4px; font-size:11px; text-align:center; }
}
</style>
</head>

<body>

<header>
  <img src="assets/logo.png">
  <h2>Philippine Red Cross ‚Äì Baguio City Chapter</h2>
</header>

<div class="container">

<!-- Back to homepage -->
<div class="noPrint" style="margin-bottom:10px;">
  <button onclick="location.href='dashboard.html'">Back to Homepage</button>
</div>

<!-- Search -->
<div class="searchRow noPrint">
  <input type="text" id="searchInput" placeholder="Search donor..." style="flex:1; padding:6px; border-radius:5px; border:1px solid #ccc;">
  <button onclick="exportGoogleSheet()">Export to Google Sheet</button>
  <button onclick="window.print()">Print Donor List</button>
  <button id="skippedBtn" onclick="showSkippedSerials()">Skipped Serial Numbers</button>
</div>

<!-- Donor Table -->
<table id="donorTable">
  <thead>
    <tr>
      <th>#</th>
      <th>Date</th>
      <th>Donor Type</th>
      <th>Suffix</th>
      <th>Surname</th>
      <th>First Name</th>
      <th>Middle Name</th>
      <th>Birthday</th>
      <th>Age</th>
      <th>Sex</th>
      <th>Contact</th>
      <th>Address</th>
      <th>City</th>
      <th>Serial</th>
      <th>Blood Type</th>
      <th>Times</th>
      <th>Bag Used</th>
      <th>Bag Type</th>
      <th>Amount</th>
      <th>Time</th>
      <th class="noPrint">Edit</th>
      <th class="noPrint">Delete</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

</div>

<script>
let donors = [];
let skippedSerials = [];

function addDonor(donor) {
  // Handle skipped serial numbers
  if(!donor.serial) skippedSerials.push(donor.surname+" "+donor.firstName);
  donors.push(donor);
  renderTable();
}

function renderTable() {
  const tbody = document.querySelector("#donorTable tbody");
  tbody.innerHTML = "";
  donors.forEach((d,i)=>{
    const bloodClass = d.bloodType.replace("+","").replace("-","");
    tbody.innerHTML += `<tr>
      <td>${i+1}</td>
      <td>${d.date}</td>
      <td>${d.donorType}</td>
      <td>${d.suffix}</td>
      <td>${d.surname}</td>
      <td>${d.firstName}</td>
      <td>${d.middleName}</td>
      <td>${d.birthday}</td>
      <td>${d.age}</td>
      <td>${d.sex}</td>
      <td>${d.contact}</td>
      <td>${d.address}</td>
      <td>${d.city}</td>
      <td>${d.serial?'PRC2600-'+d.serial:''}</td>
      <td class="${bloodClass}">${d.bloodType}</td>
      <td>${d.times}</td>
      <td>${d.bagUsed==="Karmi"?"K":d.bagUsed==="Terumo"?"T":d.bagUsed}</td>
      <td>${d.bagType[0]}</td>
      <td>${d.amount}</td>
      <td>${d.time}</td>
      <td class="noPrint"><button onclick="editDonor(${i})">‚úèÔ∏è</button></td>
      <td class="noPrint"><button onclick="deleteDonor(${i})">üóëÔ∏è</button></td>
    </tr>`;
  });
}

// Delete donor
function deleteDonor(index){
  donors.splice(index,1);
  renderTable();
}

// Edit donor
function editDonor(index){
  const d = donors[index];
  alert("Implement donor edit form here for: "+d.firstName);
}

// Export to Google Sheet placeholder
function exportGoogleSheet(){
  alert("This will link/export to Google Sheet using API or CSV download.");
}

// Show skipped serial numbers
function showSkippedSerials(){
  if(skippedSerials.length===0) alert("No skipped serial numbers.");
  else alert("Skipped Serial Numbers:\n"+skippedSerials.join("\n"));
}

// Example search filter (simple)
document.getElementById("searchInput").addEventListener("input", function(){
  const val = this.value.toLowerCase();
  document.querySelectorAll("#donorTable tbody tr").forEach(row=>{
    row.style.display = Array.from(row.cells).some(c=>c.textContent.toLowerCase().includes(val))?"":"none";
  });
});

</script>

</body>
</html>

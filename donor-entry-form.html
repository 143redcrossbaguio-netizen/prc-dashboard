<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PRC Baguio - Donor Entry</title>
<link rel="stylesheet" href="css/style.css">
<style>
body { font-family: Arial; margin:0; background:#fff; color:#b71c1c; }
header { background:#b71c1c; color:white; padding:10px 20px; display:flex; align-items:center; }
header img { height:50px; margin-right:15px; }
h1,h2 { margin:0; }
.container { padding:20px; max-width:1200px; margin:auto; }
form { display:grid; grid-gap:15px; }

/* One-line sections */
.line { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
.line input { padding:5px; font-size:14px; }
.line label { width:auto; white-space:nowrap; }

/* Full width input */
.full { width:100%; }

input[type="submit"], button { padding:10px 20px; background:#b71c1c; color:white; border:none; cursor:pointer; margin-top:10px; }
input[type="submit"]:hover, button:hover { background:#a11212; }
.center-btn { display:flex; justify-content:center; margin:20px 0; }
</style>
</head>
<body>

<header>
<img src="assets/logo.png" alt="PRC Logo">
<div>
<h1>Philippine Red Cross</h1>
<h2>Baguio City Chapter - Donor Entry</h2>
</div>
</header>

<div class="container">
<form id="donorForm">

<!-- Donor Type Top -->
<div class="line">
<label>Donor Type</label>
<input type="text" id="donorType" maxlength="1" placeholder="W/M/P">
<input type="text" id="conditionalBox" placeholder="If MBD/Patient Directed" style="display:none;">
</div>

<!-- Name: Suffix / Surname / First / Middle -->
<div class="line">
<label>Suffix</label><input type="text" id="suffix" maxlength="4" style="width:50px">
<label>Surname</label><input type="text" id="surname">
<label>First Name</label><input type="text" id="firstName">
<label>Middle Name</label><input type="text" id="middleName">
</div>

<!-- Birthday + Age -->
<div class="line">
<label>Birth Day</label><input type="number" id="birthDay" min="1" max="31" style="width:60px">
<label>Birth Month</label><input type="number" id="birthMonth" min="1" max="12" style="width:60px">
<label>Birth Year</label><input type="number" id="birthYear" min="1900" max="2100" style="width:80px">
<label>Age</label><input type="number" id="age" readonly style="width:60px">
</div>

<!-- Contact + Serial Number -->
<div class="line">
<label>Contact</label>
<input type="text" id="contact1" maxlength="4" placeholder="XXXX" style="width:60px">
<input type="text" id="contact2" maxlength="3" placeholder="XXX" style="width:50px">
<input type="text" id="contact3" maxlength="4" placeholder="XXXX" style="width:60px">
<label>Serial Number</label>
<input type="text" id="serial" readonly value="PRC2600-">
</div>

<!-- Blood Type + Times Donated -->
<div class="line">
<label>Blood Type</label><input type="text" id="bloodType" maxlength="3" style="width:80px">
<label># Times Donated</label><input type="number" id="numDonations" min="1" style="width:60px">
</div>

<!-- Blood Bag + Bag Type + Amount Collected -->
<div class="line">
<label>Blood Bag Used</label><input type="text" id="bloodBag" maxlength="1" style="width:80px">
<label>Blood Bag Type</label><input type="text" id="bagType" maxlength="1" style="width:80px">
<label>Amount Collected</label><input type="text" id="amountCollected" maxlength="1" style="width:80px">
</div>

<!-- Time Started + Time Ended -->
<div class="line">
<label>Start HH</label><input type="number" id="timeStartH" min="1" max="12" style="width:60px">
<label>Start MM</label><input type="number" id="timeStartM" min="1" max="60" style="width:60px">
<label>End HH</label><input type="number" id="timeEndH" min="1" max="12" style="width:60px">
<label>End MM</label><input type="number" id="timeEndM" min="1" max="60" style="width:60px">
</div>

<!-- Submit -->
<div class="center-btn">
<input type="submit" value="Submit">
</div>

</form>

<!-- Go to Donor List -->
<div class="center-btn">
<button onclick="window.location.href='donor-list.html'">Go to Donor List</button>
</div>

</div>

<script>
// Donor type auto-fill
const donorTypeInput = document.getElementById("donorType");
const conditionalBox = document.getElementById("conditionalBox");
donorTypeInput.addEventListener("input", ()=>{
    const val = donorTypeInput.value.toUpperCase();
    if(val=="W"){ donorTypeInput.value="Walk-in"; conditionalBox.style.display="none"; }
    else if(val=="M"){ donorTypeInput.value="MBD"; conditionalBox.style.display="inline-block"; }
    else if(val=="P"){ donorTypeInput.value="Patient Directed"; conditionalBox.style.display="inline-block"; }
});

// Age calculation
function calculateAge(){
    const dd=parseInt(document.getElementById("birthDay").value);
    const mm=parseInt(document.getElementById("birthMonth").value);
    let yy=parseInt(document.getElementById("birthYear").value);
    if(yy<100) yy += (yy>30)?1900:2000;
    const today=new Date();
    let age=today.getFullYear()-yy;
    if(today.getMonth()+1<mm || (today.getMonth()+1==mm && today.getDate()<dd)) age--;
    document.getElementById("age").value=age;
}
document.getElementById("birthDay").addEventListener("input",calculateAge);
document.getElementById("birthMonth").addEventListener("input",calculateAge);
document.getElementById("birthYear").addEventListener("input",calculateAge);

// Blood type auto-fill + color
const bloodTypeInput = document.getElementById("bloodType");
bloodTypeInput.addEventListener("input", ()=>{
    const val = bloodTypeInput.value.toUpperCase();
    let color="";
    if(val=="AP") { bloodTypeInput.value="A+"; color="blue"; }
    else if(val=="AN") { bloodTypeInput.value="A-"; color="blue"; }
    else if(val=="BP") { bloodTypeInput.value="B+"; color="yellow"; }
    else if(val=="BN") { bloodTypeInput.value="B-"; color="yellow"; }
    else if(val=="ABP") { bloodTypeInput.value="AB+"; color="pink"; }
    else if(val=="ABN") { bloodTypeInput.value="AB-"; color="pink"; }
    else if(val=="OP") { bloodTypeInput.value="O+"; color="white"; }
    else if(val=="ON") { bloodTypeInput.value="O-"; color="white"; }
    bloodTypeInput.style.background=color;
});

// Blood Bag auto-fill
const bloodBag = document.getElementById("bloodBag");
bloodBag.addEventListener("input", ()=>{
    const val = bloodBag.value.toUpperCase();
    if(val=="K") bloodBag.value="Karmi";
    else if(val=="T") bloodBag.value="Terumo";
});

// Bag Type auto-fill
const bagType = document.getElementById("bagType");
bagType.addEventListener("input", ()=>{
    const val = bagType.value.toUpperCase();
    if(val=="S") bagType.value="Single";
    else if(val=="D") bagType.value="Double";
    else if(val=="T") bagType.value="Triple";
    else if(val=="Q") bagType.value="Quadruple";
});

// Amount collected auto-fill
const amountCollected = document.getElementById("amountCollected");
amountCollected.addEventListener("input", ()=>{
    const val = amountCollected.value.toUpperCase();
    if(val=="4") amountCollected.value="450ml";
    else if(val=="Q") amountCollected.value="QNS";
    else if(val=="U") amountCollected.value="UB";
});

// Contact auto-cursor
const contact1=document.getElementById("contact1");
const contact2=document.getElementById("contact2");
const contact3=document.getElementById("contact3");
contact1.addEventListener("input",()=>{ if(contact1.value.length>=4) contact2.focus(); });
contact2.addEventListener("input",()=>{ if(contact2.value.length>=3) contact3.focus(); });

// Submit form
document.getElementById("donorForm").addEventListener("submit", function(e){
    e.preventDefault();
    const donor={
        donorType:donorTypeInput.value,
        conditional:conditionalBox.value,
        suffix:document.getElementById("suffix").value,
        surname:document.getElementById("surname").value,
        firstName:document.getElementById("firstName").value,
        middleName:document.getElementById("middleName").value,
        birthDay:document.getElementById("birthDay").value,
        birthMonth:document.getElementById("birthMonth").value,
        birthYear:document.getElementById("birthYear").value,
        age:document.getElementById("age").value,
        contact1:contact1.value,
        contact2:contact2.value,
        contact3:contact3.value,
        serial:document.getElementById("serial").value,
        bloodType:document.getElementById("bloodType").value,
        numDonations:document.getElementById("numDonations").value,
        bloodBag:bloodBag.value,
        bagType:bagType.value,
        amountCollected:amountCollected.value,
        timeStartH:document.getElementById("timeStartH").value,
        timeStartM:document.getElementById("timeStartM").value,
        timeEndH:document.getElementById("timeEndH").value,
        timeEndM:document.getElementById("timeEndM").value
    };
    let donors=JSON.parse(localStorage.getItem("donors")||"[]");
    donors.push(donor);
    localStorage.setItem("donors",JSON.stringify(donors));
    alert("Donor added!");
    this.reset();
    conditionalBox.style.display="none";
});
</script>

</body>
</html>
